<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ebook.mapper.BookMapper">

    <resultMap id="selectBookWithBookChaptersByBookNo" type="BookDTO" autoMapping="true">
        <id property="bookNo" column="bookNo"/>
        <collection property="bookChapters" ofType="BookChapterDTO" javaType="list" autoMapping="true">
            <id property="no" column="bookChapterNo" />
        </collection>
    </resultMap>


    <select id="select_book_by_no" resultType="BookDTO" resultMap="selectBookWithBookChaptersByBookNo">
        SELECT
            B.no AS 'bookNo',
            BC.no AS 'bookChapterNo',
            B.*, BC.*
        FROM `book_chapter` BC
            INNER JOIN `books` B
            on B.no = BC.book_no
        WHERE B.no = #{bookNo}
    </select>
</mapper>